# Talos GCP Deployment Configuration (Reference)
# Usage: ./talos-gcp -c examples/talos.env deploy

# --- Cluster Identity ---
# Unique name for the cluster (used for resource naming)
CLUSTER_NAME="talos-gcp-cluster"



# Region and Zone
REGION="us-central1"
ZONE="us-central1-b"

# --- Versions ---
# Global Talos Version
TALOS_VERSION="v1.12.3"
# Kubectl Version to download/use
KUBECTL_VERSION="v1.35.0"
# Traefik Version
TRAEFIK_VERSION="3.6.8"

# --- Control Plane Configuration ---
# Number of Control Plane Nodes
CP_COUNT=1
# Machine Type
CP_MACHINE_TYPE="e2-standard-2"
# Disk Size (GB)
CP_DISK_SIZE="200GB"
# Specific Talos Version for CP (defaults to TALOS_VERSION)
CP_TALOS_VERSION="$TALOS_VERSION"
# Extensions (Comma-separated, e.g., "siderolabs/gvisor")
# Defaults to empty
# CP_EXTENSIONS=""

# --- Worker Configuration ---
# Number of Worker Nodes
WORKER_COUNT=1
# Machine Type
WORKER_MACHINE_TYPE="e2-standard-2"
# Disk Size (GB)
WORKER_DISK_SIZE="200GB"
# Specific Talos Version for Workers (defaults to TALOS_VERSION)
WORKER_TALOS_VERSION="$TALOS_VERSION"
# Extensions (Comma-separated)
# Defaults to empty
# WORKER_EXTENSIONS=""

# --- Custom Worker Machine Type ---
# Only used if WORKER_MACHINE_TYPE="custom"
# WORKER_MACHINE_FAMILY="n2" # Default: n2
# WORKER_VCPU="32"          # Required for custom
# WORKER_MEMORY_GB="64"     # Required for custom

# --- Additional Storage ---
# Additional Persistent Disks for Workers (e.g. for Rook/Ceph or Local Path Provisioner)
# Format: type:size:device-name (space-separated)
# Defaults to empty
# WORKER_ADDITIONAL_DISKS="pd-ssd:100GB:fast-data pd-standard:500GB:slow-data"

# --- Network Configuration ---
# VPC Name (Defaults to ${CLUSTER_NAME}-vpc)
VPC_NAME="${CLUSTER_NAME}-vpc"
# Subnet CIDR for Nodes (Default: 10.100.0.0/20)
SUBNET_RANGE="10.100.0.0/20"
# Pod CIDR (Alias IPs) (Default: 10.200.0.0/14)
POD_CIDR="10.200.0.0/14"
# Service CIDR (Default: 10.96.0.0/20)
SERVICE_CIDR="10.96.0.0/20"

# Multi-NIC Storage Network (e.g. for Ceph replication isolation)
# Defaults to empty (disabled). Set CIDR to enable (e.g. "172.16.0.0/24")
# STORAGE_CIDR=""

# --- Firewall / Security ---
# Custom Open Ports for Workers (e.g. for WebRTC, NodePorts)
# Format: "START-END" or "PORT"
# Defaults to empty
# WORKER_OPEN_TCP_PORTS="30000-32767"
# WORKER_OPEN_UDP_PORTS="30000-32767"
# User Source Ranges for Custom Ports (Default: 0.0.0.0/0)
WORKER_OPEN_SOURCE_RANGES="0.0.0.0/0"

# --- CNI / Cilium ---
# Install Cilium CNI (Default: true)
INSTALL_CILIUM="true"
# Install Hubble Observability (Default: true)
INSTALL_HUBBLE="true"
# Install GCP CSI Driver (Default: true)
INSTALL_CSI="true"

# Cilium Routing Mode (native vs tunnel)
# Native uses VPC native routing (Alias IPs). Tunnel uses Geneve/VXLAN.
CILIUM_ROUTING_MODE="native"
# Native CIDR for Cilium (Defaults to POD_CIDR)
CILIUM_NATIVE_CIDR="$POD_CIDR"

# --- Ingress ---
# Number of Static External IPs to reserve for Ingress (Default: 1)
INGRESS_IP_COUNT=1
# Specific IP Name to reuse (optional)
# INGRESS_IPV4_CONFIG=""

# --- Scheduling (Cost Savings) ---
# Automatically stop/start cluster instances
# Start Time (HH:MM, 24h format). Empty = Disabled
# WORK_HOURS_START="08:00"
# Stop Time (HH:MM, 24h format). Empty = Disabled
# WORK_HOURS_STOP="18:00"
# Days of week (Default: Mon-Fri)
WORK_HOURS_DAYS="Mon-Fri"
# Timezone (Defaults to auto-detect based on Region, e.g. "Europe/Berlin")
# WORK_HOURS_TIMEZONE="UTC"

# --- Service Accounts ---
# Service Account Name (Defaults to ${CLUSTER_NAME}-${REGION_HASH}-sa)
# SA_NAME="my-custom-sa"

# Role-specific Service Accounts (Defaults to the main cluster SA)
# CP_SERVICE_ACCOUNT="cp-sa@project.iam.gserviceaccount.com"
# WORKER_SERVICE_ACCOUNT="worker-sa@project.iam.gserviceaccount.com"

# --- Labels ---
# GCP Resource Labels (Comma separated key=value)
# Defaults to empty
# LABELS="environment=dev,owner=admin"

# --- Bastion Host ---
# Bastion Image (Defaults to Ubuntu 24.04 LTS)
BASTION_IMAGE_FAMILY="ubuntu-2404-lts-amd64"
BASTION_IMAGE_PROJECT="ubuntu-os-cloud"
